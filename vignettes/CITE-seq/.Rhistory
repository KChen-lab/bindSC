"UMAP1"=dt$UMAP1[dt$method=="seurat"],
"UMAP2"=dt$UMAP1[dt$method=="seurat"],
"datatype"=citeseq@meta$datatype)
p1 <- myplot(dt=dt_plt[dt_plt$datatype=="Protein",],
title="Protein (Seurat)",
xmin=min(dt_plt$UMAP1),
xmax=max(dt_plt$UMAP1),
ymin=min(dt_plt$UMAP2),
ymax=max(dt_plt$UMAP2))
p2 <- myplot(dt=dt_plt[dt_plt$datatype=="RNA",],
title="RNA (Seurat)",
xmin=min(dt_plt$UMAP1),
xmax=max(dt_plt$UMAP1),
ymin=min(dt_plt$UMAP2),
ymax=max(dt_plt$UMAP2))
dt_plt<- data.frame("celltype.l1"=citeseq@meta$celltype,
"UMAP1"=dt$UMAP1[dt$method=="liger"],
"UMAP2"=dt$UMAP1[dt$method=="liger"],
"datatype"=citeseq@meta$datatype)
p1 <- myplot(dt=dt_plt[dt_plt$datatype=="Protein",],
title="Protein (LIGER)",
xmin=min(dt_plt$UMAP1),
xmax=max(dt_plt$UMAP1),
ymin=min(dt_plt$UMAP2),
ymax=max(dt_plt$UMAP2))
p2 <- myplot(dt=dt_plt[dt_plt$datatype=="RNA",],
title="RNA (LIGER)",
xmin=min(dt_plt$UMAP1),
xmax=max(dt_plt$UMAP1),
ymin=min(dt_plt$UMAP2),
ymax=max(dt_plt$UMAP2))
p <-ggarrange(p1,p2,p3,p4,ncol=2)
dt_plt<- data.frame("celltype.l1"=citeseq@meta$celltype,
"UMAP1"=dt$UMAP1[dt$method=="seurat"],
"UMAP2"=dt$UMAP1[dt$method=="seurat"],
"datatype"=citeseq@meta$datatype)
p1 <- myplot(dt=dt_plt[dt_plt$datatype=="Protein",],
title="Protein (Seurat)",
xmin=min(dt_plt$UMAP1),
xmax=max(dt_plt$UMAP1),
ymin=min(dt_plt$UMAP2),
ymax=max(dt_plt$UMAP2))
p2 <- myplot(dt=dt_plt[dt_plt$datatype=="RNA",],
title="RNA (Seurat)",
xmin=min(dt_plt$UMAP1),
xmax=max(dt_plt$UMAP1),
ymin=min(dt_plt$UMAP2),
ymax=max(dt_plt$UMAP2))
dt_plt<- data.frame("celltype.l1"=citeseq@meta$celltype,
"UMAP1"=dt$UMAP1[dt$method=="liger"],
"UMAP2"=dt$UMAP1[dt$method=="liger"],
"datatype"=citeseq@meta$datatype)
p3 <- myplot(dt=dt_plt[dt_plt$datatype=="Protein",],
title="Protein (LIGER)",
xmin=min(dt_plt$UMAP1),
xmax=max(dt_plt$UMAP1),
ymin=min(dt_plt$UMAP2),
ymax=max(dt_plt$UMAP2))
p4 <- myplot(dt=dt_plt[dt_plt$datatype=="RNA",],
title="RNA (LIGER)",
xmin=min(dt_plt$UMAP1),
xmax=max(dt_plt$UMAP1),
ymin=min(dt_plt$UMAP2),
ymax=max(dt_plt$UMAP2))
p <-ggarrange(p1,p2,p3,p4,ncol=2)
p
dt_plt<- data.frame("celltype.l1"=citeseq@meta$celltype,
"UMAP1"=dt$UMAP1[dt$method=="seurat"],
"UMAP2"=dt$UMAP2[dt$method=="seurat"],
"datatype"=citeseq@meta$datatype)
p1 <- myplot(dt=dt_plt[dt_plt$datatype=="Protein",],
title="Protein (Seurat)",
xmin=min(dt_plt$UMAP1),
xmax=max(dt_plt$UMAP1),
ymin=min(dt_plt$UMAP2),
ymax=max(dt_plt$UMAP2))
p2 <- myplot(dt=dt_plt[dt_plt$datatype=="RNA",],
title="RNA (Seurat)",
xmin=min(dt_plt$UMAP1),
xmax=max(dt_plt$UMAP1),
ymin=min(dt_plt$UMAP2),
ymax=max(dt_plt$UMAP2))
dt_plt<- data.frame("celltype.l1"=citeseq@meta$celltype,
"UMAP1"=dt$UMAP1[dt$method=="liger"],
"UMAP2"=dt$UMAP2[dt$method=="liger"],
"datatype"=citeseq@meta$datatype)
p3 <- myplot(dt=dt_plt[dt_plt$datatype=="Protein",],
title="Protein (LIGER)",
xmin=min(dt_plt$UMAP1),
xmax=max(dt_plt$UMAP1),
ymin=min(dt_plt$UMAP2),
ymax=max(dt_plt$UMAP2))
p4 <- myplot(dt=dt_plt[dt_plt$datatype=="RNA",],
title="RNA (LIGER)",
xmin=min(dt_plt$UMAP1),
xmax=max(dt_plt$UMAP1),
ymin=min(dt_plt$UMAP2),
ymax=max(dt_plt$UMAP2))
p <-ggarrange(p1,p2,p3,p4,ncol=2,nrow=2)
p
dt_plt$UMAP1
summary(dt_plt$UMAP1)
summary(dt_plt$UMAP2)
p3 <- myplot(dt=dt_plt[dt_plt$datatype=="Protein",],
title="Protein (LIGER)",
xmin=min(dt_plt$UMAP1),
xmax=max(dt_plt$UMAP1),
ymin=min(dt_plt$UMAP2),
ymax=max(dt_plt$UMAP2))
p4 <- myplot(dt=dt_plt[dt_plt$datatype=="RNA",],
title="RNA (LIGER)",
xmin=(-15),
xmax=15,
ymin=(-18),
ymax=18)
p <-ggarrange(p1,p2,p3,p4,ncol=2,nrow=2)
p
p3 <- myplot(dt=dt_plt[dt_plt$datatype=="Protein",],
title="Protein (LIGER)",
xmin=(-15),
xmax=15,
ymin=(-18),
ymax=18)
p4 <- myplot(dt=dt_plt[dt_plt$datatype=="RNA",],
title="RNA (LIGER)",
xmin=(-15),
xmax=15,
ymin=(-18),
ymax=18)
p <-ggarrange(p1,p2,p3,p4,ncol=2,nrow=2)
p
dt_plt<- data.frame("celltype.l1"=citeseq@meta$celltype,
"UMAP1"=citeseq@biCCA$umap$layout[,1],
"UMAP2"=citeseq@biCCA$umap$layout[,2],
"datatype"=citeseq@meta$datatype)
p1 <- myplot(dt=dt_plt[dt_plt$datatype=="Protein",],
title="Protein (bindSC)",
xmin=min(dt_plt$UMAP1),
xmax=max(dt_plt$UMAP1),
ymin=min(dt_plt$UMAP2),
ymax=max(dt_plt$UMAP2))
p2 <- myplot(dt=dt_plt[dt_plt$datatype=="RNA",],
title="RNA (bindSC)",
xmin=min(dt_plt$UMAP1),
xmax=max(dt_plt$UMAP1),
ymin=min(dt_plt$UMAP2),
ymax=max(dt_plt$UMAP2))
p <-ggarrange(p1,p2,ncol=2)
p
dt_plt<- data.frame("celltype.l1"=citeseq@meta$celltype,
"UMAP1"=citeseq@biCCA$umap$layout[,1],
"UMAP2"=citeseq@biCCA$umap$layout[,2],
"datatype"=citeseq@meta$datatype)
p1 <- myplot(dt=dt_plt[dt_plt$datatype=="Protein",],
title="Protein (bindSC)",
xmin=min(dt_plt$UMAP1),
xmax=max(dt_plt$UMAP1),
ymin=min(dt_plt$UMAP2),
ymax=max(dt_plt$UMAP2))
p2 <- myplot(dt=dt_plt[dt_plt$datatype=="RNA",],
title="RNA (bindSC)",
xmin=min(dt_plt$UMAP1),
xmax=max(dt_plt$UMAP1),
ymin=min(dt_plt$UMAP2),
ymax=max(dt_plt$UMAP2))
p <-ggarrange(p1,p2,ncol=2)
p
source("./figPlot.R")
dt_plt<- data.frame("celltype.l1"=citeseq@meta$celltype,
"UMAP1"=citeseq@biCCA$umap$layout[,1],
"UMAP2"=citeseq@biCCA$umap$layout[,2],
"datatype"=citeseq@meta$datatype)
p1 <- myplot(dt=dt_plt[dt_plt$datatype=="Protein",],
title="Protein (bindSC)",
xmin=min(dt_plt$UMAP1),
xmax=max(dt_plt$UMAP1),
ymin=min(dt_plt$UMAP2),
ymax=max(dt_plt$UMAP2))
p2 <- myplot(dt=dt_plt[dt_plt$datatype=="RNA",],
title="RNA (bindSC)",
xmin=min(dt_plt$UMAP1),
xmax=max(dt_plt$UMAP1),
ymin=min(dt_plt$UMAP2),
ymax=max(dt_plt$UMAP2))
p <-ggarrange(p1,p2,ncol=2)
p
myplot
dt_plt<- data.frame("celltype.l1"=citeseq@meta$celltype,
"UMAP1"=dt$UMAP1[dt$method=="seurat"],
"UMAP2"=dt$UMAP2[dt$method=="seurat"],
"datatype"=citeseq@meta$datatype)
p1 <- myplot(dt=dt_plt[dt_plt$datatype=="Protein",],
title="Protein (Seurat)",
xmin=min(dt_plt$UMAP1),
xmax=max(dt_plt$UMAP1),
ymin=min(dt_plt$UMAP2),
ymax=max(dt_plt$UMAP2))
p2 <- myplot(dt=dt_plt[dt_plt$datatype=="RNA",],
title="RNA (Seurat)",
xmin=min(dt_plt$UMAP1),
xmax=max(dt_plt$UMAP1),
ymin=min(dt_plt$UMAP2),
ymax=max(dt_plt$UMAP2))
dt_plt<- data.frame("celltype.l1"=citeseq@meta$celltype,
"UMAP1"=dt$UMAP1[dt$method=="liger"],
"UMAP2"=dt$UMAP2[dt$method=="liger"],
"datatype"=citeseq@meta$datatype)
p3 <- myplot(dt=dt_plt[dt_plt$datatype=="Protein",],
title="Protein (LIGER)",
xmin=(-15),
xmax=15,
ymin=(-18),
ymax=18)
p4 <- myplot(dt=dt_plt[dt_plt$datatype=="RNA",],
title="RNA (LIGER)",
xmin=(-15),
xmax=15,
ymin=(-18),
ymax=18)
p <-ggarrange(p1,p2,p3,p4,ncol=2,nrow=2)
p
geeeeeeeeeeeeeeeeetwd90
getwd()
knitr::opts_chunk$set(echo = TRUE)
source("./figPlot.R")
library(ggplot2)
p1 <- myplot(dt=rna_3000HVG_umap,title="RNA (3000 genes)[Y]")
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
source("./figPlot.R")
rna_3000HVG_umap <- read.csv(file="../../inst/CITE-seq/rna.HVG3000.umap.csv")
protein_umap <- read.csv(file="../../inst/CITE-seq/rna.25protein.umap.csv")
rna_25gene_umap <- read.csv(file="../../inst/CITE-seq/rna.25gene.umap.csv")
p1 <- myplot(dt=rna_3000HVG_umap,title="RNA (3000 genes)[Y]")
p2 <- myplot(dt=rna_25gene_umap,title="RNA (25 protein)[Z]")
p3 <- myplot(dt=protein_umap,title="Protein (25 protein)[X]")
p <-ggarrange(p3,p2,p1,ncol=3)
p
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
source("./figPlot.R")
source("../../R/ColorPalettes.R")
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(ggrepel)
source("./figPlot.R")
source("../../R/ColorPalettes.R")
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(ggrepel)
library(ggpubr)
source("./figPlot.R")
source("../../R/ColorPalettes.R")
DefaultAssay()
bm
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(ggrepel)
library(ggpubr)
source("./figPlot.R")
library(Seurat)
source("../../R/ColorPalettes.R")
# 24 gene names (PTPPRC is duplicated)
genelst <- c("ITGAL","ITGAX","IL3RA","IL7R","CD14","FCGR3A",
"KLRB1","CD19","CCR7","IL2RA","CD27","ICOS",
"CD28","CD3E","CD34","CD38","CD4",
"PTPRC","NCAM1","B3GAT1","CD69","CD79B","CD8A",
"HLA-DRA")
DefaultAssay(bm)<-"RNA"
bm<-FindVariableFeatures(bm, nfeatures = 3000)
varGene <- VariableFeatures(bm)
mat2 <- bm[["ADT"]][]
X <- mat2[rownames(mat2)!="CD45RO",]
Y  <- bm[["RNA"]][varGene,]
Z <- bm[["RNA"]][genelst,]
rownames(Z) <- rownames(X)
# Remove cells that have no expression on 25 proteins
qc_id<-(colSums(Z)>2)
X <- X[,qc_id]
Y <- Y[,qc_id]
Z <- Z[,qc_id]
library(bindSC)
citeseq <- createBindSCobj(X=X, Z0=Z, Y=Y)
celltype <- bm@meta.data$celltype.l1[qc_id]
type <- c(rep("Protein",ncol(X)), rep("RNA",ncol(X)))
citeseq <- addMetaData(citeseq, celltype,name="celltype")
citeseq <- addMetaData(citeseq, type,name="datatype")
citeseq<- runBiCCA(citeseq,
k=10,
alpha =0.5,
block.size =5000,
num.iteration = 10,
tolerance = 0.01,
temp.path = "tp" )
source("./figPlot.R")
dt_plt<- data.frame("celltype.l1"=citeseq@meta$celltype,
"UMAP1"=citeseq@biCCA$umap$layout[,1],
"UMAP2"=citeseq@biCCA$umap$layout[,2],
"datatype"=citeseq@meta$datatype)
p1 <- myplot(dt=dt_plt[dt_plt$datatype=="Protein",],
title="Protein (bindSC)",
xmin=min(dt_plt$UMAP1),
xmax=max(dt_plt$UMAP1),
ymin=min(dt_plt$UMAP2),
ymax=max(dt_plt$UMAP2))
p2 <- myplot(dt=dt_plt[dt_plt$datatype=="RNA",],
title="RNA (bindSC)",
xmin=min(dt_plt$UMAP1),
xmax=max(dt_plt$UMAP1),
ymin=min(dt_plt$UMAP2),
ymax=max(dt_plt$UMAP2))
p <-ggarrange(p1,p2,ncol=2)
p
dt_plt<- data.frame("celltype.l1"=citeseq@meta$celltype,
"UMAP1"=dt$UMAP1[dt$method=="seurat"],
"UMAP2"=dt$UMAP2[dt$method=="seurat"],
"datatype"=citeseq@meta$datatype)
p1 <- myplot(dt=dt_plt[dt_plt$datatype=="Protein",],
title="Protein (Seurat)",
xmin=min(dt_plt$UMAP1),
xmax=max(dt_plt$UMAP1),
ymin=min(dt_plt$UMAP2),
ymax=max(dt_plt$UMAP2))
p2 <- myplot(dt=dt_plt[dt_plt$datatype=="RNA",],
title="RNA (Seurat)",
xmin=min(dt_plt$UMAP1),
xmax=max(dt_plt$UMAP1),
ymin=min(dt_plt$UMAP2),
ymax=max(dt_plt$UMAP2))
dt_plt<- data.frame("celltype.l1"=citeseq@meta$celltype,
"UMAP1"=dt$UMAP1[dt$method=="liger"],
"UMAP2"=dt$UMAP2[dt$method=="liger"],
"datatype"=citeseq@meta$datatype)
p3 <- myplot(dt=dt_plt[dt_plt$datatype=="Protein",],
title="Protein (LIGER)",
xmin=(-15),
xmax=15,
ymin=(-18),
ymax=18)
p4 <- myplot(dt=dt_plt[dt_plt$datatype=="RNA",],
title="RNA (LIGER)",
xmin=(-15),
xmax=15,
ymin=(-18),
ymax=18)
p <-ggarrange(p1,p2,p3,p4,ncol=2,nrow=2)
p
varGene
# 24 gene names (PTPPRC is duplicated)
genelst <- c("ITGAL","ITGAX","IL3RA","IL7R","CD14","FCGR3A",
"KLRB1","CD19","CCR7","IL2RA","CD27","ICOS",
"CD28","CD3E","CD34","CD38","CD4",
"PTPRC","NCAM1","B3GAT1","CD69","CD79B","CD8A",
"HLA-DRA")
DefaultAssay(bm)<-"RNA"
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(ggrepel)
library(ggpubr)
source("./figPlot.R")
library(Seurat)
source("../../R/ColorPalettes.R")
library(SeuratData)
InstallData("bmcite")
bm <- LoadData(ds="bmcite")
bm
rna_3000HVG_umap <- read.csv(file="../../inst/CITE-seq/rna.HVG3000.umap.csv")
protein_umap <- read.csv(file="../../inst/CITE-seq/rna.25protein.umap.csv")
rna_25gene_umap <- read.csv(file="../../inst/CITE-seq/rna.25gene.umap.csv")
p1 <- myplot(dt=rna_3000HVG_umap,title="RNA (3000 genes)[Y]")
p2 <- myplot(dt=rna_25gene_umap,title="RNA (25 protein)[Z]")
p3 <- myplot(dt=protein_umap,title="Protein (25 protein)[X]")
p <-ggarrange(p3,p2,p1,ncol=3)
p
# 24 gene names (PTPPRC is duplicated)
genelst <- c("ITGAL","ITGAX","IL3RA","IL7R","CD14","FCGR3A",
"KLRB1","CD19","CCR7","IL2RA","CD27","ICOS",
"CD28","CD3E","CD34","CD38","CD4",
"PTPRC","NCAM1","B3GAT1","CD69","CD79B","CD8A",
"HLA-DRA")
DefaultAssay(bm)<-"RNA"
bm<-FindVariableFeatures(bm, nfeatures = 3000)
varGene <- VariableFeatures(bm)
mat2 <- bm[["ADT"]][]
X <- mat2[rownames(mat2)!="CD45RO",]
Y  <- bm[["RNA"]][varGene,]
Z <- bm[["RNA"]][genelst,]
rownames(Z) <- rownames(X)
# Remove cells that have no expression on 25 proteins
qc_id<-(colSums(as.matrix(Z)>2))
X <- X[,qc_id]
Y <- Y[,qc_id]
Z <- Z[,qc_id]
library(bindSC)
citeseq <- createBindSCobj(X=X, Z0=Z, Y=Y)
celltype <- bm@meta.data$celltype.l1[qc_id]
type <- c(rep("Protein",ncol(X)), rep("RNA",ncol(X)))
citeseq <- addMetaData(citeseq, celltype,name="celltype")
citeseq <- addMetaData(citeseq, type,name="datatype")
citeseq<- runBiCCA(citeseq,
k=10,
alpha =0.5,
block.size =5000,
num.iteration = 10,
tolerance = 0.01,
temp.path = "tp" )
dim(X)
dim(Y)
dim(Z)
mat2 <- bm[["ADT"]][]
X <- mat2[rownames(mat2)!="CD45RO",]
Y  <- bm[["RNA"]][varGene,]
Z <- bm[["RNA"]][genelst,]
rownames(Z) <- rownames(X)
dim(x)
dim(X)
dim(Y)
dim(Z)
# Remove cells that have no expression on 25 proteins
qc_id<-(colSums(as.matrix(Z)>2))
qc_id
# 24 gene names (PTPPRC is duplicated)
genelst <- c("ITGAL","ITGAX","IL3RA","IL7R","CD14","FCGR3A",
"KLRB1","CD19","CCR7","IL2RA","CD27","ICOS",
"CD28","CD3E","CD34","CD38","CD4",
"PTPRC","NCAM1","B3GAT1","CD69","CD79B","CD8A",
"HLA-DRA")
DefaultAssay(bm)<-"RNA"
bm<-FindVariableFeatures(bm, nfeatures = 3000)
varGene <- VariableFeatures(bm)
mat2 <- bm[["ADT"]][]
X <- mat2[rownames(mat2)!="CD45RO",]
Y  <- bm[["RNA"]][varGene,]
Z <- bm[["RNA"]][genelst,]
rownames(Z) <- rownames(X)
# Remove cells that have no expression on 25 proteins
qc_id<-(colSums(as.matrix(Z))>2)
X <- X[,qc_id]
Y <- Y[,qc_id]
Z <- Z[,qc_id]
library(bindSC)
citeseq <- createBindSCobj(X=X, Z0=Z, Y=Y)
celltype <- bm@meta.data$celltype.l1[qc_id]
type <- c(rep("Protein",ncol(X)), rep("RNA",ncol(X)))
citeseq <- addMetaData(citeseq, celltype,name="celltype")
citeseq <- addMetaData(citeseq, type,name="datatype")
citeseq<- runBiCCA(citeseq,
k=10,
alpha =0.5,
block.size =5000,
num.iteration = 10,
tolerance = 0.01,
temp.path = "tp" )
source("./figPlot.R")
dt_plt<- data.frame("celltype.l1"=citeseq@meta$celltype,
"UMAP1"=citeseq@biCCA$umap$layout[,1],
"UMAP2"=citeseq@biCCA$umap$layout[,2],
"datatype"=citeseq@meta$datatype)
p1 <- myplot(dt=dt_plt[dt_plt$datatype=="Protein",],
title="Protein (bindSC)",
xmin=min(dt_plt$UMAP1),
xmax=max(dt_plt$UMAP1),
ymin=min(dt_plt$UMAP2),
ymax=max(dt_plt$UMAP2))
p2 <- myplot(dt=dt_plt[dt_plt$datatype=="RNA",],
title="RNA (bindSC)",
xmin=min(dt_plt$UMAP1),
xmax=max(dt_plt$UMAP1),
ymin=min(dt_plt$UMAP2),
ymax=max(dt_plt$UMAP2))
p <-ggarrange(p1,p2,ncol=2)
p
dt_plt<- data.frame("celltype.l1"=citeseq@meta$celltype,
"UMAP1"=dt$UMAP1[dt$method=="seurat"],
"UMAP2"=dt$UMAP2[dt$method=="seurat"],
"datatype"=citeseq@meta$datatype)
dt
dt <- read.csv(file="../../inst/CITE-seq/umap_plt.csv")
dt_plt<- data.frame("celltype.l1"=citeseq@meta$celltype,
"UMAP1"=dt$UMAP1[dt$method=="seurat"],
"UMAP2"=dt$UMAP2[dt$method=="seurat"],
"datatype"=citeseq@meta$datatype)
p1 <- myplot(dt=dt_plt[dt_plt$datatype=="Protein",],
title="Protein (Seurat)",
xmin=min(dt_plt$UMAP1),
xmax=max(dt_plt$UMAP1),
ymin=min(dt_plt$UMAP2),
ymax=max(dt_plt$UMAP2))
p2 <- myplot(dt=dt_plt[dt_plt$datatype=="RNA",],
title="RNA (Seurat)",
xmin=min(dt_plt$UMAP1),
xmax=max(dt_plt$UMAP1),
ymin=min(dt_plt$UMAP2),
ymax=max(dt_plt$UMAP2))
dt_plt<- data.frame("celltype.l1"=citeseq@meta$celltype,
"UMAP1"=dt$UMAP1[dt$method=="liger"],
"UMAP2"=dt$UMAP2[dt$method=="liger"],
"datatype"=citeseq@meta$datatype)
p3 <- myplot(dt=dt_plt[dt_plt$datatype=="Protein",],
title="Protein (LIGER)",
xmin=(-15),
xmax=15,
ymin=(-18),
ymax=18)
p4 <- myplot(dt=dt_plt[dt_plt$datatype=="RNA",],
title="RNA (LIGER)",
xmin=(-15),
xmax=15,
ymin=(-18),
ymax=18)
p <-ggarrange(p1,p2,p3,p4,ncol=2,nrow=2)
p
